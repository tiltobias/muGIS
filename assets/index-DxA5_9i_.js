import{e as U,f as d,j as e,M as de,S as pe,F as fe,h as me,k as he,l as xe,m as ye,G as je,X as _,n as D,C as be,o as ge,q as ve,t as Ce,w as Se,x as Le,y as Ne,z as we,E as ke,T as ee,A as Pe,Z as Ee,P as Fe,B as Te,D as te,H as se,I as re,J as Re,K as W,L as q,N as Me,O as Oe,Q as $e,U as Ie,V as Be,W as Ae,Y as Ue,_ as Ve,$ as We,a0 as qe}from"./vendor--Fcjl3zd.js";import{m as B,M as ze}from"./vendor-mapbox-C-xPK6R5.js";import{b as ne,i as le,u as He,c as Je,d as Ge,a as Z,f as $,v as Ze,e as z,g as Ke,p as Xe,h as K,l as Ye}from"./vendor-turf-xlNcsDkQ.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function a(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerPolicy&&(o.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?o.credentials="include":l.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(l){if(l.ep)return;l.ep=!0;const o=a(l);fetch(l.href,o)}})();const I=U(t=>({mapRef:d.createRef(),setMapRef:s=>t({mapRef:s}),mapReady:!1,setMapReady:s=>t({mapReady:s}),basemap:{url:"mapbox://styles/mapbox/streets-v12",name:"Streets"},setBasemap:s=>t(a=>s.url===a.basemap.url?a:{basemap:s}),resetMapStore:()=>t(()=>({mapReady:!1,basemap:{url:"mapbox://styles/mapbox/streets-v12",name:"Streets"}}))}));function X(t){return t==="Polygon"||t==="MultiPolygon"?"fill":t==="LineString"||t==="MultiLineString"?"line":t==="Point"||t==="MultiPoint"?"circle":null}const N=U(t=>({layers:[],resetLayerStore:()=>t(()=>({layers:[]})),loadProjectLayers:s=>t(()=>({layers:s})),addLayer:s=>t(a=>{const r=c=>a.layers.some(n=>n.id===c)?r(c+"1"):c,l=s.featureCollection.features[0].geometry.type,o=X(l);if(s.featureCollection.features.forEach(c=>{if(X(c.geometry.type)!==o)throw new Error(`All features must have the same geometry (rendering) type, found both ${l} and ${c.geometry.type}`)}),!o)throw new Error("Unsupported geometry type: "+l);s.name||(s.name=o==="fill"?"polygon":o==="line"?"line":o==="circle"?"point":"not possible");const i={h:Math.floor(Math.random()*360),s:90,l:48,a:o==="fill"?.7:1};return{layers:[{featureCollection:s.featureCollection,id:r(s.name),name:s.name,renderingType:o,visible:!0,color:i,outline:s.outline},...a.layers]}}),moveLayerUp:s=>t(a=>{const r=a.layers.findIndex(o=>o.id===s);if(r===0)return a;const l=[...a.layers];return l.splice(r-1,0,l.splice(r,1)[0]),{layers:l}}),moveLayerDown:s=>t(a=>{const r=a.layers.findIndex(o=>o.id===s);if(r===a.layers.length-1)return a;const l=[...a.layers];return l.splice(r+1,0,l.splice(r,1)[0]),{layers:l}}),deleteLayer:s=>t(a=>({layers:a.layers.filter(r=>r.id!==s)})),toggleLayerVisibility:s=>t(a=>({layers:a.layers.map(r=>r.id===s?{...r,visible:!r.visible}:r)})),toggleLayerVisibilityAll:()=>t(s=>{const a=s.layers.every(r=>r.visible);return{layers:s.layers.map(r=>({...r,visible:!a}))}}),changeLayerColor:(s,a)=>t(r=>({layers:r.layers.map(l=>l.id===s?{...l,color:a}:l)})),updateAllLayers:()=>t(s=>({layers:s.layers.map(a=>({...a,updater:a.updater?a.updater+1:1}))})),changeLayerName:(s,a)=>t(r=>({layers:r.layers.map(l=>l.id===s?{...l,name:a}:l)}))}));B.accessToken="pk.eyJ1IjoidG9iaWFuZCIsImEiOiJjbTdiMGZwemwwNmxlMnFyNTV4YWh2ZzB3In0.B3fVZMQOYEs2V23kKWB5XQ";const Qe=()=>{const{mapRef:t,mapReady:s,setMapReady:a,basemap:r}=I(),{addLayer:l,updateAllLayers:o}=N(),i=d.useRef(null);d.useEffect(()=>{var m,j,b,w,C,x;if(!s&&i.current){i.current.innerHTML="",t.current=new B.Map({container:i.current,style:r.url,center:[10.4,63.425],zoom:12}),(m=t.current)==null||m.addControl(new B.FullscreenControl,"top-right"),(j=t.current)==null||j.addControl(new B.NavigationControl({visualizePitch:!0}),"top-right"),(b=t.current)==null||b.addControl(new B.ScaleControl,"bottom-right");const g=new ze({displayControlsDefault:!1,controls:{point:!0,line_string:!0,polygon:!0},boxSelect:!1});(w=t.current)==null||w.addControl(g,"bottom-left"),(C=t.current)==null||C.on("draw.create",()=>{l({featureCollection:g.getAll(),name:null}),g.deleteAll()}),(x=t.current)==null||x.on("style.load",()=>{a(!0)})}},[t,l,s,a,r]);const[p,c]=d.useState(!1),n=d.useRef(r),[u,h]=d.useState(r);return d.useEffect(()=>{var m;n.current.url!==r.url&&(n.current=r),!p&&u.url!==n.current.url&&(c(!0),s&&t.current&&(t.current.setStyle(n.current.url),h(r)),(m=t.current)==null||m.once("style.load",()=>{o()}),setTimeout(()=>{c(!1)},200))},[r,t,s,p,u,o]),e.jsx("div",{ref:i,className:"mapContainer"})},O=(t,s,a=[])=>{d.useEffect(()=>{const r=l=>{const o=l.target;t.current&&!t.current.contains(o)&&!a.some(i=>{var p;return(p=i.current)==null?void 0:p.contains(o)})&&s()};return document.addEventListener("click",r),()=>{document.removeEventListener("click",r)}},[t,s,a])},_e=()=>{const[t,s]=d.useState(!1),a=d.useRef(null);O(a,()=>{s(!1)});const[r,l]=d.useState(null),{basemap:o,setBasemap:i}=I(),p=[{url:"mapbox://styles/mapbox/streets-v12",name:"Streets"},{url:"mapbox://styles/mapbox/outdoors-v12",name:"Outdoors"},{url:"mapbox://styles/mapbox/light-v11",name:"Light"},{url:"mapbox://styles/mapbox/dark-v11",name:"Dark"},{url:"mapbox://styles/mapbox/satellite-v9",name:"Satellite"},{url:"mapbox://styles/mapbox/satellite-streets-v12",name:"Satellite Streets"},{url:"mapbox://styles/mapbox/navigation-day-v1",name:"Navigation Day"},{url:"mapbox://styles/mapbox/navigation-night-v1",name:"Navigation Night"},{url:"mapbox://styles/tobiand/cm8rbg7j900be01sa5wc6d4lq",name:"Off (white)"},{url:"mapbox://styles/tobiand/cm8rbd89l00az01sb97a8hfyh",name:"Off (black)"}];return e.jsxs("div",{className:"basemap",ref:a,children:[e.jsxs("button",{type:"button",onClick:()=>s(!t),children:[e.jsx(de,{})," Change basemap"]}),t&&e.jsx("div",{className:"basemapPopover",children:e.jsx("ul",{onMouseEnter:()=>{l(o)},onMouseLeave:()=>{i(r),l(null)},children:p.map(c=>e.jsx("li",{children:e.jsxs("button",{type:"button",onClick:()=>{l(c)},onMouseEnter:()=>{i(c)},children:[r===null&&c.name===o.name||r!==null&&c.name===r.name?"*":"",c.name]})},c.name))})})]})},De=U(t=>({theme:localStorage.getItem("theme")||"light",setTheme:s=>t(a=>(localStorage.setItem("theme",s),s===a.theme?a:{theme:s}))})),et=()=>{const[t,s]=d.useState(!1),a=d.useRef(null);O(a,()=>{s(!1)});const{layers:r,resetLayerStore:l,loadProjectLayers:o}=N(),{basemap:i,setBasemap:p,resetMapStore:c}=I(),{theme:n,setTheme:u}=De(),h=()=>{l(),c()},m=()=>{const C={layers:r,basemap:i},x=new Blob([JSON.stringify(C)],{type:"application/json"}),g=URL.createObjectURL(x),S=document.createElement("a");S.href=g,S.download="μGIS_project.mugis",document.body.appendChild(S),S.click(),document.body.removeChild(S),URL.revokeObjectURL(g)},j=d.useRef(null),b=()=>{var C;(C=j.current)==null||C.click()},w=C=>{const x=C.target.files;if(!x){console.log("no file selected");return}const g=new FileReader;g.onload=S=>{var E;try{const F=JSON.parse((E=S.target)==null?void 0:E.result);o(F.layers),p(F.basemap)}catch(F){console.log(F)}},g.readAsText(x[0])};return d.useEffect(()=>{document.documentElement.setAttribute("data-theme",n)},[n]),e.jsxs("div",{className:"settings",ref:a,children:[e.jsx("button",{type:"button",onClick:()=>{s(!t)},children:e.jsx(pe,{})}),t&&e.jsx("div",{className:"settingsPopover",children:e.jsxs("ul",{children:[e.jsx("li",{children:e.jsxs("button",{type:"button",onClick:h,children:[e.jsx(fe,{})," New project"]})}),e.jsx("li",{children:e.jsxs("button",{type:"button",onClick:m,children:[e.jsx(me,{})," Save project"]})}),e.jsxs("li",{children:[e.jsx("input",{ref:j,type:"file",accept:".mugis",onChange:w}),e.jsxs("button",{type:"button",onClick:b,children:[e.jsx(he,{})," Load project"]})]}),e.jsx("li",{children:e.jsx(_e,{})}),e.jsx("li",{children:e.jsxs("button",{type:"button",onClick:C=>{C.stopPropagation(),u(n==="light"?"dark":"light")},children:[n==="light"?e.jsx(xe,{}):e.jsx(ye,{})," Toggle theme"]})}),e.jsx("li",{children:e.jsxs("button",{type:"button",onClick:()=>{},children:[e.jsx(je,{})," Start tutorial"]})})]})})]})},R=({children:t,buttonLabel:s,onFormSubmit:a,buttonIcon:r})=>{const[l,o]=d.useState(!1),[i,p]=d.useState(!1);return e.jsxs("div",{children:[e.jsxs("button",{type:"button",className:"toolButton",onClick:()=>o(!l),children:[r," ",s]}),l&&e.jsx("div",{className:"cover",onClick:c=>{c.target===c.currentTarget&&o(!1)},children:e.jsx("div",{className:"modal"+(i?" loading":""),children:e.jsxs("form",{onSubmit:c=>{c.preventDefault(),p(!0),setTimeout(()=>{a()&&o(!1),p(!1)},0)},children:[e.jsx("button",{type:"button",className:"modalCloseButton",onClick:()=>o(!1),children:e.jsx(_,{})}),e.jsx("h3",{children:s}),t,e.jsx("button",{type:"submit",children:"Submit"})]})})})]})};function oe({size:t=120}){return e.jsxs("svg",{width:t,height:t,viewBox:"0 0 120 120",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{style:{fill:"none",stroke:"currentColor",strokeWidth:16,strokeLinejoin:"round",strokeOpacity:1},d:"M 15,55 50,80 70,40 105,65"}),e.jsx("circle",{cx:"15",cy:"55",r:"12",fill:"currentColor"}),e.jsx("circle",{cx:"50",cy:"80",r:"12",fill:"currentColor"}),e.jsx("circle",{cx:"70",cy:"40",r:"12",fill:"currentColor"}),e.jsx("circle",{cx:"105",cy:"65",r:"12",fill:"currentColor"})]})}function ie({size:t=120}){return e.jsx("svg",{width:t,height:t,viewBox:"0 0 120 120",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("circle",{cx:"60",cy:"60",r:"25",fill:"currentColor"})})}function ae({size:t=120}){return e.jsxs("svg",{width:t,height:t,viewBox:"0 0 120 120",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{style:{fill:"currentColor",stroke:"currentColor",strokeWidth:16,strokeLinejoin:"round",strokeOpacity:1,fillOpacity:.5},d:"M 60,17 100,48 88,95 H 32 L 20,48 60,17"}),e.jsx("circle",{cx:"60",cy:"17",r:"12",fill:"currentColor"}),e.jsx("circle",{cx:"100",cy:"48",r:"12",fill:"currentColor"}),e.jsx("circle",{cx:"88",cy:"95",r:"12",fill:"currentColor"}),e.jsx("circle",{cx:"32",cy:"95",r:"12",fill:"currentColor"}),e.jsx("circle",{cx:"20",cy:"48",r:"12",fill:"currentColor"})]})}function tt(){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{width:"20",height:"20",x:"2",y:"2",rx:"2"}),e.jsx("circle",{cx:"7",cy:"9",r:"1"}),e.jsx("circle",{cx:"9",cy:"17",r:"1"}),e.jsx("circle",{cx:"17",cy:"10",r:"1"}),e.jsx("line",{x1:"11.7436",y1:"12.0641",x2:"19.5625",y2:"21"}),e.jsx("line",{x1:"11.7436",y1:"12.0641",x2:"12.65",y2:"3"}),e.jsx("line",{x1:"11.7436",y1:"12.0641",x2:"3",y2:"14.25"})]})}const Y=({name:t,type:s,index:a,color:r,onRemove:l})=>e.jsxs("div",{className:"layerItem",children:[e.jsxs("span",{className:"layerIndex",children:[a+1,"."]}),e.jsxs("div",{className:"colorPickerButton",style:{color:`hsl(${r.h},${r.s}%,${r.l}%)`},children:[s==="circle"&&e.jsx(ie,{}),s==="line"&&e.jsx(oe,{}),s==="fill"&&e.jsx("div",{className:"polygonShrinker",children:e.jsx(ae,{})})]}),e.jsx("div",{className:"layerName",children:e.jsx("span",{children:t})}),l&&e.jsx("button",{type:"button",onClick:o=>{l(),o.stopPropagation()},children:e.jsx(D,{})})]}),k=({selectedLayers:t,setSelectedLayers:s,renderingType:a=void 0,multiple:r=!1,unselectableLayerIds:l=[]})=>{const{layers:o}=N(),[i,p]=d.useState(!1),c=d.useRef(null),n=d.useRef(null);return O(c,()=>{p(!1)}),d.useEffect(()=>{var u,h,m,j,b,w;c.current&&n.current&&((h=n.current)==null||h.style.setProperty("max-height",`${window.innerHeight-((u=c.current)==null?void 0:u.getBoundingClientRect().bottom)-10}px`),(j=n.current)==null||j.style.setProperty("width",`${(m=c.current)==null?void 0:m.getBoundingClientRect().width}px`),(w=n.current)==null||w.style.setProperty("top",`${((b=c.current)==null?void 0:b.getBoundingClientRect().bottom)+window.scrollY}px`))},[i,t]),d.useEffect(()=>{t.forEach(u=>{l.includes(u.id)&&s(h=>h.filter(m=>m.id!==u.id))})},[l,t,s]),e.jsxs("div",{className:"selectLayersContainer",ref:c,onClick:()=>{p(!i)},children:[e.jsx("ol",{className:"selectedList",children:t.length===0?e.jsx("p",{children:"No layer selected"}):o.map((u,h)=>a&&u.renderingType!==a||!t.some(m=>m.id===u.id)?null:e.jsx("li",{children:e.jsx(Y,{name:u.name,type:u.renderingType,index:h,color:u.color,onRemove:()=>{s(m=>m.filter(j=>j.id!==u.id))}})},u.id))}),i&&e.jsxs("div",{className:"selectListContainer",onClick:u=>{r&&u.stopPropagation()},ref:n,children:[e.jsx("h4",{children:"Select Layers"}),e.jsx("ol",{className:"selectList",children:o.map((u,h)=>a&&u.renderingType!==a||t.some(m=>m.id===u.id)||l.includes(u.id)?null:e.jsx("li",{className:"selectListItem",onClick:()=>{s(r?m=>[...m,u]:[u])},children:e.jsx(Y,{name:u.name,type:u.renderingType,index:h,color:u.color})},u.id))||e.jsx("p",{children:"No layers available"})})]})]})},st=()=>{const{addLayer:t}=N(),[s,a]=d.useState([]),[r,l]=d.useState(""),[o,i]=d.useState("");d.useEffect(()=>{s[0]&&i(`buffer(${s[0].name}, ${r}m)`)},[s,r]);const p=()=>{if(!s[0]||r==="")return alert("Please select a layer and enter a radius"),!1;const c=s[0].featureCollection,n=ne(c,r*.001,{units:"kilometers"});return!n||n.features.length===0?(alert("No results found"),!1):(t({featureCollection:n,name:o}),!0)};return e.jsxs(R,{buttonLabel:"Buffer",onFormSubmit:p,buttonIcon:e.jsx(be,{}),children:[e.jsx(k,{selectedLayers:s,setSelectedLayers:a}),"buffer radius [m]: ",r,e.jsx("input",{type:"number",value:r,onChange:c=>l(c.target.value)}),e.jsx("input",{type:"text",value:o,onChange:c=>i(c.target.value)})]})},rt=()=>{const{addLayer:t}=N(),[s,a]=d.useState([]),[r,l]=d.useState("");d.useEffect(()=>{if(s&&s.length>=2){let i=s[0].name;for(let p=1;p<s.length;p++)i+=`, ${s[p].name}`;l(`intersect(${i})`)}},[s]);const o=()=>{if(!s||s.length<2)return alert("Please select two layers"),!1;const i={type:"FeatureCollection",features:s[0].featureCollection.features};for(let p=1;p<s.length;p++){const c=s[p].featureCollection,n=[];i.features.forEach(u=>{c.features.forEach(h=>{const m=le({type:"FeatureCollection",features:[u,h]});m&&n.push(m)})}),i.features=n}return!i||i.features.length===0?(alert("No results found"),!1):(t({featureCollection:i,name:r}),!0)};return e.jsxs(R,{buttonLabel:"Intersect",onFormSubmit:o,buttonIcon:e.jsx(ge,{}),children:[e.jsx(k,{selectedLayers:s,setSelectedLayers:a,renderingType:"fill",multiple:!0}),e.jsx("input",{type:"text",value:r,onChange:i=>l(i.target.value)})]})},nt=()=>{const{addLayer:t}=N(),[s,a]=d.useState([]),[r,l]=d.useState("");d.useEffect(()=>{if(s&&s.length>=2){let i=s[0].name;for(let p=1;p<s.length;p++)i+=`, ${s[p].name}`;l(`union(${i})`)}},[s]);const o=()=>{if(!s||s.length<2)return alert("Please select two layers"),!1;const i=s.flatMap(c=>c.featureCollection.features),p=He({type:"FeatureCollection",features:i});return p?(t({featureCollection:{type:"FeatureCollection",features:[p]},name:r}),!0):(alert("No results found"),!1)};return e.jsxs(R,{buttonLabel:"Union",onFormSubmit:o,buttonIcon:e.jsx(ve,{}),children:[e.jsx(k,{selectedLayers:s,setSelectedLayers:a,renderingType:"fill",multiple:!0}),e.jsx("input",{type:"text",value:r,onChange:i=>l(i.target.value)})]})},lt=()=>{var c;const{addLayer:t}=N(),[s,a]=d.useState([]),[r,l]=d.useState([]),[o,i]=d.useState("");d.useEffect(()=>{s[0]&&r[0]&&i(`difference(${s[0].name}, ${r[0].name})`)},[s,r]);const p=()=>{if(!s[0]||!r[0])return alert("Please select two layers"),!1;const n={type:"FeatureCollection",features:[]},u=s[0].featureCollection,h=r[0].featureCollection,m=Je(h).features[0];return u.features.forEach(j=>{const b=Ge({type:"FeatureCollection",features:[j,m]});b&&n.features.push(b)}),!n||n.features.length===0?(alert("No results found"),!1):(t({featureCollection:n,name:o}),!0)};return e.jsxs(R,{buttonLabel:"Difference",onFormSubmit:p,buttonIcon:e.jsx(Ce,{}),children:["select base layer:",e.jsx(k,{selectedLayers:s,setSelectedLayers:a,renderingType:"fill"}),"select layer to subtract:",e.jsx(k,{selectedLayers:r,setSelectedLayers:l,renderingType:"fill",unselectableLayerIds:[(c=s[0])==null?void 0:c.id]}),e.jsx("input",{type:"text",value:o,onChange:n=>i(n.target.value)})]})},ot=()=>{var u;const{addLayer:t}=N(),[s,a]=d.useState([]),[r,l]=d.useState(!1),[o,i]=d.useState(void 0),[p,c]=d.useState("");d.useEffect(()=>{s[0]&&c(r&&o?`dissolve(${s[0].name}, ${o})`:`dissolve(${s[0].name})`)},[s,r,o]);const n=()=>{if(!s[0])return alert("Please select a layer"),!1;const h=s[0].featureCollection,m=r&&o?Z($(h),{propertyName:o}):Z($(h));return!m||m.features.length===0?(alert("No results found"),!1):(t({featureCollection:m,name:p}),!0)};return e.jsxs(R,{buttonLabel:"Dissolve",onFormSubmit:n,buttonIcon:e.jsx(Se,{}),children:["select layer:",e.jsx(k,{selectedLayers:s,setSelectedLayers:a,renderingType:"fill"}),e.jsxs("span",{children:[e.jsx("input",{type:"checkbox",checked:r,onChange:h=>l(h.target.checked),id:"checkboxPropertyEnabled"}),e.jsxs("label",{htmlFor:"checkboxPropertyEnabled",children:["dissolve by property: ",r&&o]})]}),e.jsxs("select",{required:!0,disabled:!r,value:o,onChange:h=>i(h.target.value),children:[e.jsx("option",{value:"",children:"Select a property"}),((u=s[0])==null?void 0:u.featureCollection.features[0].properties)&&Object.keys(s[0].featureCollection.features[0].properties).map(h=>e.jsx("option",{value:h,children:h},h))]}),e.jsx("input",{type:"text",value:p,onChange:h=>c(h.target.value)})]})},it=()=>{const{addLayer:t}=N(),[s,a]=d.useState([]),[r,l]=d.useState(!1),[o,i]=d.useState([]),[p,c]=d.useState("");d.useEffect(()=>{s[0]&&(r&&o[0]?c(`voronoi(${s[0].name}, ${o[0].name})`):c(`voronoi(${s[0].name})`))},[s,o,r]);const n=()=>{if(!s[0])return alert("Please select a layer"),!1;const u=$(s[0].featureCollection),h=r&&o[0]?$(o[0].featureCollection):u,m=Ze(u,{bbox:z(h)});return!m||m.features.length===0?(alert("No results found"),!1):(m.features=m.features.filter(j=>j.geometry.type==="Polygon"),t({featureCollection:m,name:p,outline:!0}),!0)};return e.jsxs(R,{buttonLabel:"Voronoi",onFormSubmit:n,buttonIcon:e.jsx(tt,{}),children:["select layer:",e.jsx(k,{selectedLayers:s,setSelectedLayers:a,renderingType:"circle"}),e.jsxs("span",{children:[e.jsx("input",{type:"checkbox",checked:r,onChange:u=>l(u.target.checked),id:"checkboxPropertyEnabled"}),e.jsxs("label",{htmlFor:"checkboxPropertyEnabled",children:["use custom bounding box: ",r]})]}),r&&e.jsx(k,{selectedLayers:o,setSelectedLayers:i}),e.jsx("input",{type:"text",value:p,onChange:u=>c(u.target.value)})]})},at=()=>{const{addLayer:t}=N(),[s,a]=d.useState([]),[r,l]=d.useState("");d.useEffect(()=>{if(s&&s.length>=1){let i=s[0].name;for(let p=1;p<s.length;p++)i+=`, ${s[p].name}`;l(`bbox(${i})`)}},[s]);const o=()=>{if(!s||s.length<1)return alert("Please select one or more layers"),!1;const i=s.flatMap(c=>c.featureCollection.features),p=Ke(z({type:"FeatureCollection",features:i}));return p?(t({featureCollection:{type:"FeatureCollection",features:[p]},name:r}),!0):(alert("No results found"),!1)};return e.jsxs(R,{buttonLabel:"Bbox",onFormSubmit:o,buttonIcon:e.jsx(Le,{}),children:[e.jsx(k,{selectedLayers:s,setSelectedLayers:a,multiple:!0}),e.jsx("input",{type:"text",value:r,onChange:i=>l(i.target.value)})]})},ct=()=>{var c;const{addLayer:t}=N(),[s,a]=d.useState([]),[r,l]=d.useState([]),[o,i]=d.useState("");d.useEffect(()=>{s[0]&&r[0]&&i(`clip(${r[0].name}, ${s[0].name})`)},[r,s]);const p=()=>{if(!s[0]||!r[0])return alert("Please select two layers"),!1;let n={type:"FeatureCollection",features:[]};if(r[0].renderingType==="circle")n=Xe(r[0].featureCollection,s[0].featureCollection);else if(r[0].renderingType==="fill"){const u=s[0].featureCollection,h=r[0].featureCollection;u.features.forEach(m=>{h.features.forEach(j=>{const b=le({type:"FeatureCollection",features:[j,m]});b&&n.features.push(b)})})}else if(r[0].renderingType==="line"){const u=$(s[0].featureCollection),h=$(r[0].featureCollection);u.features.forEach(m=>{const j=ne(m,.01,{units:"meters"});h.features.forEach(b=>{K(b,j)?n.features.push(b):Ye(b,m).features.forEach(C=>{K(C,j)&&n.features.push(C)})})})}else throw new Error("Unknown rendering type");return!n||n.features.length===0?(alert("No results found"),!1):(t({featureCollection:n,name:o}),!0)};return e.jsxs(R,{buttonLabel:"Clip",onFormSubmit:p,buttonIcon:e.jsx(Ne,{}),children:["select layer:",e.jsx(k,{selectedLayers:r,setSelectedLayers:l}),"select mask layer:",e.jsx(k,{selectedLayers:s,setSelectedLayers:a,renderingType:"fill",unselectableLayerIds:[(c=r[0])==null?void 0:c.id]}),e.jsx("input",{type:"text",value:o,onChange:n=>i(n.target.value)})]})},ut=()=>e.jsxs(e.Fragment,{children:[e.jsx(st,{}),e.jsx(rt,{}),e.jsx(nt,{}),e.jsx(lt,{}),e.jsx(ot,{}),e.jsx(it,{}),e.jsx(at,{}),e.jsx(ct,{})]}),dt=({setWidth:t,setOpen:s})=>{const{mapRef:a}=I(),r=d.useRef(null),[l,o]=d.useState(!1),i=n=>{o(!0),n.preventDefault(),n.stopPropagation()},p=d.useCallback(()=>{o(!1),setTimeout(()=>{var n;(n=a.current)==null||n.resize()},1),setTimeout(()=>{var n;(n=a.current)==null||n.resize()},100)},[a]),c=d.useCallback(n=>{var u;l&&((u=a.current)==null||u.resize(),t(n.clientX),n.clientX<100?s(!1):s(!0))},[l,a,t,s]);return d.useEffect(()=>(window.addEventListener("mousemove",c),window.addEventListener("mouseup",p),()=>{window.removeEventListener("mousemove",c),window.removeEventListener("mouseup",p)}),[l,c,p]),e.jsx("div",{className:`resizeHandle ${l?"resizing":""}`,onMouseDown:i,ref:r})},pt=({color:t,onChange:s,layerType:a})=>{const[r,l]=d.useState(!1),o=d.useRef(null);return O(o,()=>{l(!1)}),e.jsxs("div",{className:"colorPicker",ref:o,children:[e.jsxs("button",{type:"button",className:"colorPickerButton",onClick:()=>{l(!r)},style:{color:`hsl(${t.h},${t.s}%,${t.l}%)`},children:[a==="circle"&&e.jsx(ie,{}),a==="line"&&e.jsx(oe,{}),a==="fill"&&e.jsx("div",{className:"polygonShrinker",children:e.jsx(ae,{})})]}),r&&e.jsx("div",{className:"colorPickerPopover",children:e.jsx(we,{color:t,onChange:i=>{s(i)}})})]})},ft=({layerId:t,initialLayerName:s,isEditing:a,setIsEditing:r,closeMenu:l})=>{const{changeLayerName:o}=N(),[i,p]=d.useState(s),c=d.useRef(null);return d.useEffect(()=>{a&&c.current&&c.current.focus()},[a,c]),O(c,()=>{a&&(o(t,i),r(!1),l())}),e.jsx("div",{className:"layerNameContainer",children:a?e.jsx("form",{onSubmit:n=>{n.preventDefault(),o(t,i),r(!1)},children:e.jsx("input",{type:"text",value:i,onChange:n=>p(n.target.value),ref:c,onFocus:()=>r(!0),onBlur:()=>o(t,i)})}):e.jsx("div",{className:"layerName",children:e.jsx("span",{onDoubleClick:()=>r(!0),children:i})})})},mt=["=","!=","<","<=",">",">="],ht=["=","!=","contains","does not contain","starts with","does not start with","ends with","does not end with"],A={active:!1,attribute:"",attributeType:"string",operator:"=",value:""},H=U(t=>({selectedLayer:[],setSelectedLayer:s=>t(a=>typeof s=="function"?{selectedLayer:s(a.selectedLayer)}:{selectedLayer:s}),tableOpen:!1,setTableOpen:s=>t(()=>({tableOpen:s})),openTableWithLayer:s=>t(()=>({tableOpen:!0,selectedLayer:s})),filters:[{...A}],resetFilters:()=>t(()=>({filters:[{...A}]})),addFilter:()=>t(s=>{const a={...A};return{filters:[...s.filters,a]}}),removeFilter:s=>t(a=>{const r=[...a.filters];return r.splice(s,1),r.length===0&&r.push({...A}),{filters:r}}),updateFilter:(s,a)=>t(r=>{const l=[...r.filters];return l[s]=a,{filters:l}}),filterConnector:"and",setFilterConnector:s=>t(()=>({filterConnector:s}))}));function Q(t,s){var p,c;const{active:a,attribute:r,attributeType:l,operator:o,value:i}=s;if(!a)return!0;if(l==="number"){const n=(p=t.properties)==null?void 0:p[r];if(n==null)switch(o){case"=":return i===void 0||i===""||Number.isNaN(i);case"!=":return i!==void 0&&i!==""&&!Number.isNaN(i);default:return!1}const u=i;switch(o){case"=":return n===u;case"!=":return n!==u;case"<":return n<u;case"<=":return n<=u;case">":return n>u;case">=":return n>=u;default:return!1}}else{const n=(c=t.properties)==null?void 0:c[r];if(n==null)switch(o){case"=":return i===void 0||i==="";case"!=":return i!==void 0&&i!=="";default:return!1}const u=i;switch(o){case"=":return String(n)===u;case"!=":return String(n)!==u;case"contains":return String(n).includes(u);case"does not contain":return!String(n).includes(u);case"starts with":return String(n).startsWith(u);case"does not start with":return!String(n).startsWith(u);case"ends with":return String(n).endsWith(u);case"does not end with":return!String(n).endsWith(u);default:return!1}}}const xt=({layerData:t,layerAboveId:s,index:a})=>{const[r,l]=d.useState(!1),o=d.useRef(null);O(o,()=>{l(!1)});const{deleteLayer:i,toggleLayerVisibility:p,changeLayerColor:c}=N(),{mapRef:n}=I(),{openTableWithLayer:u}=H();d.useEffect(()=>{var x,g,S,E;(x=n.current)!=null&&x.getSource(t.id)||(g=n.current)==null||g.addSource(t.id,{type:"geojson",data:t.featureCollection}),(S=n.current)!=null&&S.getLayer(t.id)||(E=n.current)==null||E.addLayer({id:t.id,type:t.renderingType,source:t.id,paint:t.renderingType==="fill"?{"fill-color":`hsl(${t.color.h},${t.color.s}%,${t.color.l}%)`,"fill-opacity":t.color.a,...t.outline?{"fill-outline-color":"black"}:{}}:t.renderingType==="line"?{"line-color":`hsl(${t.color.h},${t.color.s}%,${t.color.l}%)`,"line-opacity":t.color.a,"line-width":2}:t.renderingType==="circle"?{"circle-color":`hsl(${t.color.h},${t.color.s}%,${t.color.l}%)`,"circle-opacity":t.color.a,"circle-radius":5}:{}})},[n,t]),d.useEffect(()=>{var x;(x=n.current)==null||x.moveLayer(t.id,s)},[s,t.id,n,t.updater]),d.useEffect(()=>{var x;(x=n.current)==null||x.setLayoutProperty(t.id,"visibility",t.visible?"visible":"none")},[t.visible,n,t.id,t.updater]);const h=x=>{var g,S,E,F,P,M;c(t.id,x),t.renderingType==="fill"?((g=n.current)==null||g.setPaintProperty(t.id,"fill-color",`hsl(${x.h},${x.s}%,${x.l}%)`),(S=n.current)==null||S.setPaintProperty(t.id,"fill-opacity",x.a)):t.renderingType==="line"?((E=n.current)==null||E.setPaintProperty(t.id,"line-color",`hsl(${x.h},${x.s}%,${x.l}%)`),(F=n.current)==null||F.setPaintProperty(t.id,"line-opacity",x.a)):t.renderingType==="circle"&&((P=n.current)==null||P.setPaintProperty(t.id,"circle-color",`hsl(${x.h},${x.s}%,${x.l}%)`),(M=n.current)==null||M.setPaintProperty(t.id,"circle-opacity",x.a))},m=()=>{var x,g;(x=n.current)==null||x.removeLayer(t.id),(g=n.current)==null||g.removeSource(t.id),i(t.id)},j=()=>{const x=new Blob([JSON.stringify(t.featureCollection)],{type:"application/geo+json"}),g=URL.createObjectURL(x),S=document.createElement("a");S.href=g,S.download=t.name+".geojson",document.body.appendChild(S),S.click(),document.body.removeChild(S),URL.revokeObjectURL(g)},b=()=>{var g;const x=z(t.featureCollection).slice(0,4);(g=n.current)==null||g.fitBounds(x,{padding:20})},[w,C]=d.useState(!1);return e.jsxs("div",{className:"layerItem",children:[e.jsxs("span",{className:"layerIndex",children:[a+1,"."]}),e.jsx(pt,{color:t.color,onChange:h,layerType:t.renderingType}),e.jsx(ft,{layerId:t.id,initialLayerName:t.name,isEditing:w,setIsEditing:C,closeMenu:()=>l(!1)}),e.jsxs("div",{className:`layerMenu ${r?"open":""}`,ref:o,children:[e.jsx("button",{type:"button",onClick:()=>{l(!r)},children:e.jsx(ke,{})}),r&&e.jsx("div",{className:"layerMenuPopover",children:e.jsxs("ul",{children:[e.jsx("li",{children:e.jsxs("button",{type:"button",onClick:m,children:[e.jsx(ee,{})," Delete layer"]})}),e.jsx("li",{children:e.jsxs("button",{type:"button",onClick:j,children:[e.jsx(Pe,{})," Download layer"]})}),e.jsx("li",{children:e.jsxs("button",{type:"button",onClick:b,children:[e.jsx(Ee,{})," Zoom to layer"]})}),e.jsx("li",{children:e.jsxs("button",{type:"button",onClick:x=>{x.stopPropagation(),C(!w)},children:[w?e.jsx(Te,{}):e.jsx(Fe,{})," Edit layer name"]})}),e.jsx("li",{children:e.jsxs("button",{type:"button",onClick:()=>{u([t])},children:[e.jsx(te,{})," Attribute table"]})})]})})]}),e.jsx("button",{type:"button",onClick:()=>p(t.id),children:t.visible?e.jsx(se,{}):e.jsx(re,{})})]})},yt=()=>{const{layers:t,moveLayerUp:s,moveLayerDown:a}=N(),[r,l]=d.useState(null),[o,i]=d.useState(null);d.useEffect(()=>{r!==null&&i(r)},[r]);const p=(u,h)=>{l(h),u.dataTransfer.setDragImage(new Image,0,0)},c=(u,h)=>{u.preventDefault(),u.dataTransfer.dropEffect="move",!(r===null||r===h)&&(t.findIndex(m=>m.id===r)<t.findIndex(m=>m.id===h)?a(r):s(r))},n=()=>{l(null)};return e.jsx("ol",{className:"layerList",children:t.map((u,h)=>e.jsx("li",{draggable:!0,className:`layerListItem ${o===u.id?"hovering":""}`,onDragStart:m=>p(m,u.id),onDragOver:m=>c(m,u.id),onDragEnd:n,onMouseOver:()=>r===null?i(u.id):void 0,onMouseOut:()=>r===null?i(null):void 0,children:e.jsx(xt,{layerData:u,layerAboveId:h===0?void 0:t[h-1].id,index:h})},u.id))})},V=({options:t,selectedOption:s,setSelectedOption:a,placeholder:r="Select an option",clearable:l=!1})=>{const[o,i]=d.useState(!1),p=d.useRef(null),c=d.useRef(null);return O(p,()=>{i(!1)}),d.useEffect(()=>{var n,u,h,m,j,b;p.current&&c.current&&((u=c.current)==null||u.style.setProperty("max-height",`${window.innerHeight-((n=p.current)==null?void 0:n.getBoundingClientRect().bottom)-10}px`),(m=c.current)==null||m.style.setProperty("width",`${(h=p.current)==null?void 0:h.getBoundingClientRect().width}px`),(b=c.current)==null||b.style.setProperty("top",`${((j=p.current)==null?void 0:j.getBoundingClientRect().bottom)+window.scrollY}px`))},[o,s]),e.jsxs("div",{className:"selectLayersContainer",ref:p,onClick:()=>{i(!o)},children:[e.jsx("div",{className:"selectedList",children:s?e.jsxs("div",{className:"layerItem",children:[e.jsx("div",{className:"layerName",children:s}),l&&o&&e.jsx("button",{type:"button",onClick:n=>{a(""),n.stopPropagation()},children:e.jsx(D,{})})]}):e.jsx("div",{className:"layerName",children:r})}),o&&e.jsx("div",{className:"selectListContainer",ref:c,children:e.jsxs("ol",{className:"selectList",children:[t.map(n=>e.jsx("li",{className:"selectListItem",onClick:u=>{u.stopPropagation(),a(n),i(!1)},children:e.jsx("div",{className:"selectItem",children:n})},n)),t.length===0&&e.jsx("p",{children:"No options available"})]})})]})},jt=({headers:t,headerTypes:s})=>{const{filters:a,addFilter:r,removeFilter:l,updateFilter:o,filterConnector:i,setFilterConnector:p}=H();return e.jsxs("div",{className:"filterContainer",children:[e.jsxs("div",{className:"filterHeader",children:[e.jsxs("div",{className:"filterConnector",children:[e.jsx("span",{children:"Combine filters by: "}),e.jsx(V,{options:["and","or"],selectedOption:i,setSelectedOption:c=>p(c),placeholder:"Select connector",clearable:!1})]}),e.jsxs("button",{onClick:r,children:[e.jsx(Re,{}),"Add Filter"]})]}),e.jsx("div",{className:"filterRows",children:a.map((c,n)=>e.jsxs("div",{className:"filterRow"+(c.active?" active":""),children:[e.jsx(V,{options:t,selectedOption:c.attribute,setSelectedOption:u=>o(n,{...c,attribute:u,attributeType:s[t.indexOf(u)]||"string"}),placeholder:"Select an attribute",clearable:!0}),e.jsx(V,{options:c.attributeType==="number"?[...mt]:[...ht],selectedOption:c.operator,setSelectedOption:u=>o(n,{...c,operator:u}),placeholder:"Select operator"}),e.jsx("input",{type:c.attributeType==="number"?"number":"text",placeholder:`Enter ${c.attributeType} value`,value:c.value,onChange:u=>o(n,{...c,value:c.attributeType==="number"?parseFloat(u.target.value):u.target.value})}),e.jsx("button",{type:"button",className:`filterToggle ${c.active?"active":""}`,onClick:()=>{o(n,{...c,active:!c.active})},children:c.active?e.jsx(W,{}):e.jsx(q,{})}),e.jsx("button",{onClick:()=>l(n),children:e.jsx(ee,{})})]},n))})]})},bt=()=>{const{selectedLayer:t,setSelectedLayer:s,tableOpen:a,setTableOpen:r,filters:l,filterConnector:o}=H(),[i,p]=d.useState([]);d.useEffect(()=>{p(t.length>0?t[0].featureCollection.features.map((f,y)=>{const v={...f.properties||{},mugisSelected:!1,mugisIndex:y};return{...f,properties:v}}):[]),console.log("Selected layer changed:",t)},[t]);const c=d.useMemo(()=>{const f=new Set;return i.forEach(y=>{y&&y.properties&&Object.keys(y.properties).forEach(v=>f.add(v))}),f.delete("mugisSelected"),f.delete("mugisIndex"),f.forEach(y=>{i.map(L=>{var T;return(T=L.properties)==null?void 0:T[y]}).every(L=>Array.isArray(L)||L===null||L===void 0)&&f.delete(y)}),Array.from(f)},[i]),n=d.useMemo(()=>c.map(f=>i.map(v=>{var L;return(L=v.properties)==null?void 0:L[f]}).filter(v=>v!=null).every(v=>typeof v=="number")?"number":"string"),[c,i]),[u,h]=d.useState(!1),m=d.useMemo(()=>l.filter(f=>f.active),[l]),j=d.useMemo(()=>m.length===0?i:i.filter(f=>o==="and"?m.every(y=>Q(f,y)):m.some(y=>Q(f,y))),[i,m,o]),[b,w]=d.useState(null),[C,x]=d.useState(!0),g=d.useMemo(()=>b?[...j].sort((f,y)=>{const v=f&&f.properties&&b in f.properties?f.properties[b]??"":"",L=y&&y.properties&&b in y.properties?y.properties[b]??"":"";return v===L?0:v===void 0?1:L===void 0?-1:v<L?C?-1:1:v>L?C?1:-1:0}):j,[j,b,C]),S=f=>{b===f?C?x(!1):w(null):(w(f),x(!0))},{addLayer:E}=N(),F=()=>{if(t.length===0||i.length===0)return;const f=j.filter(y=>{var v;return(v=y.properties)==null?void 0:v.mugisSelected}).map(y=>({...y,properties:{...y.properties,mugisSelected:void 0,mugisIndex:void 0}}));f.length!==0&&(E({featureCollection:{type:"FeatureCollection",features:f},name:`selection(${t[0].name})`,outline:t[0].outline}),r(!1))},[P,M]=d.useState(1);return e.jsxs("div",{children:[e.jsx("button",{type:"button",className:"toolButton",onClick:()=>r(!a),children:e.jsx(te,{})}),a&&e.jsx("div",{className:"cover",onClick:f=>{f.target===f.currentTarget&&r(!1)},children:e.jsxs("div",{className:"attributeTable",children:[e.jsx("button",{type:"button",className:"modalCloseButton",onClick:()=>r(!1),children:e.jsx(_,{})}),e.jsx("h3",{children:"Attribute Table"}),e.jsxs("div",{className:"tableInputHeader",children:[e.jsx(k,{selectedLayers:t,setSelectedLayers:s}),e.jsxs("button",{type:"button",className:`openFilterButton ${l.some(f=>f.active)?"active":""}`,onClick:()=>h(!u),children:[e.jsx(Me,{})," ",u?"Close Filter":"Open Filter"]})]}),u&&e.jsx(jt,{headers:c,headerTypes:n}),e.jsx("div",{className:"tableContainer",children:t.length>0&&e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("button",{type:"button",className:"selectAll",onClick:()=>{j.every(f=>{var y;return!((y=f.properties)!=null&&y.mugisSelected)})?p(f=>f.map(y=>{const v={...y.properties||{},mugisSelected:!0};return{...y,properties:v}})):p(f=>f.map(y=>{const v={...y.properties||{},mugisSelected:!1};return{...y,properties:v}}))},children:j.every(f=>f.properties.mugisSelected)?e.jsx(W,{}):j.every(f=>!f.properties.mugisSelected)?e.jsx(q,{}):e.jsx(Oe,{})})}),c.map((f,y)=>e.jsx("th",{children:e.jsxs("button",{type:"button",onClick:()=>S(f),children:[f,e.jsx("div",{className:"sortIcon",children:b===f&&(C?e.jsx($e,{}):e.jsx(Ie,{}))})]})},y))]})}),e.jsx("tbody",{children:g.slice((P-1)*100,P*100).map((f,y)=>{var v;return e.jsxs("tr",{className:(v=f.properties)!=null&&v.mugisSelected?"selected":"",children:[e.jsx("td",{children:e.jsx("button",{type:"button",onClick:()=>{p(L=>L.map((T,ce)=>{var J,G;if(ce===((J=f.properties)==null?void 0:J.mugisIndex)){const ue={...T.properties||{},mugisSelected:!((G=T.properties)!=null&&G.mugisSelected)};return{...T,properties:ue}}return T}))},children:f.properties.mugisSelected?e.jsx(W,{}):e.jsx(q,{})})}),c.map((L,T)=>e.jsx("td",{children:f.properties&&!Array.isArray(f.properties[L])&&f.properties[L]!==null&&f.properties[L]!==void 0?String(f.properties[L]):""},T))]},y)})})]})}),t.length>0&&e.jsxs("div",{className:"tableFooter",children:[e.jsxs("span",{children:["Showing ",j.length," of ",i.length," features"]}),e.jsxs("div",{className:"tableFooterRight",children:[e.jsxs("span",{children:[(P-1)*100+1,"–",Math.min(P*100,j.length)," of ",j.length]}),e.jsxs("div",{className:"tablePagination",children:[e.jsx("button",{type:"button",onClick:()=>M(1),disabled:P<=1,children:e.jsx(Be,{})}),e.jsx("button",{type:"button",onClick:()=>M(f=>Math.max(1,f-1)),disabled:P<=1,children:e.jsx(Ae,{})}),e.jsx("button",{type:"button",onClick:()=>M(f=>Math.min(Math.ceil(j.length/100),f+1)),disabled:P>=Math.ceil(j.length/100),children:e.jsx(Ue,{})}),e.jsx("button",{type:"button",onClick:()=>M(Math.ceil(j.length/100)),disabled:P>=Math.ceil(j.length/100),children:e.jsx(Ve,{})})]})]})]}),e.jsxs("button",{type:"button",onClick:F,children:["Create Layer From Selection",j.filter(f=>{var y;return(y=f.properties)==null?void 0:y.mugisSelected}).length>0&&` (${j.filter(f=>{var y;return(y=f.properties)==null?void 0:y.mugisSelected}).length} selected)`]})]})})]})},gt=({handleLoadFileInput:t})=>{const[s,a]=d.useState(!0),[r,l]=d.useState(300),{layers:o,toggleLayerVisibilityAll:i}=N(),{mapRef:p,mapReady:c}=I();d.useEffect(()=>{const h=setInterval(()=>{var m;(m=p.current)==null||m.resize()},1);setTimeout(()=>{clearInterval(h)},1)},[p,s]);const n=d.useRef(null),u=()=>{n.current&&n.current.click()};return e.jsxs("div",{className:`sidebarContainer ${s?"open":""}`,children:[e.jsx(dt,{setWidth:l,setOpen:a}),e.jsxs("aside",{className:"sidebar",style:{width:`${r}px`},children:[e.jsxs("div",{className:"sidebarHeader",children:[e.jsx("h2",{children:"Layers"}),e.jsxs("div",{className:"sidebarHeaderActions",children:[e.jsx(bt,{}),e.jsx("button",{type:"button",onClick:i,children:o.every(h=>h.visible)?e.jsx(se,{}):e.jsx(re,{})})]})]}),e.jsx("div",{className:"layerListContainer",children:c&&e.jsx(yt,{})}),e.jsxs("div",{className:"sidebarFooter",children:[e.jsxs("button",{type:"button",onClick:u,children:[e.jsx(We,{})," Upload GeoJSON file"]}),e.jsx("input",{ref:n,type:"file",multiple:!0,accept:".geojson",onChange:t})]})]})]})};function vt(){const{addLayer:t}=N(),s=l=>{if(!l){console.log("no file selected");return}Array.from(l).forEach(o=>{const i=new FileReader;i.onload=p=>{var c;try{const n=JSON.parse((c=p.target)==null?void 0:c.result);if(n.type!=="FeatureCollection")throw new Error("Not a valid GeoJSON file, must be a FeatureCollection");t({featureCollection:n,name:o.name})}catch(n){console.log(n),alert("Error loading file: "+o.name+`
`+(n instanceof Error?n.message:String(n)))}},i.readAsText(o)})},a=l=>{s(l.target.files),l.target.value=""},r=l=>{l.preventDefault(),s(l.dataTransfer.files)};return e.jsxs("div",{className:"pageContainer",onDragOver:l=>l.preventDefault(),onDrop:r,children:[e.jsxs("header",{className:"mainHeader",children:[e.jsx("h1",{children:"μGIS"}),e.jsx(ut,{}),e.jsx(et,{})]}),e.jsxs("main",{className:"mainContainer",children:[e.jsx(gt,{handleLoadFileInput:a}),e.jsx("div",{className:"mapFlexContainer",children:e.jsx(Qe,{})})]})]})}qe.createRoot(document.getElementById("root")).render(e.jsx(d.StrictMode,{children:e.jsx(vt,{})}));
